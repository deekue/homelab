hostname: m900-1
ssh_authorized_keys:
- github:deekue
- ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIBIMWQez3DYo1jeHOOE3nG7RPllzzpKW2p2R7QwmOaoj apathy@chelone
write_files:
- path: /var/lib/rancher/k3s/server/manifests/kube-vip-ds.yaml
  owner: root:root
  permissions: '0644'
  encoding: gz+base64
  content: |
    H4sICCXJrGICA2t1YmUtdmlwLWRzLnlhbWwArVZbb9owFH7nV1g8N6y0rOryxlo0VVpRBdX2ME2V
    cQ7g4diZL1w27b/vOIFgiKnotDygcHy+8527Qwv+BbThSqZk2W0tuMxSMga95Az6jCknbSsHSzNq
    adoiRNIcUrJwE0iWvNgKTEHZTmo2xkLeSpKkRQPbekJZhzo7V5r/ohZlncWt6XD1rma9Ew6heqQE
    HFBSKZUtIcb/JVFbSK0lWChN4plyBeLRqbbVDtq155V76S6ARHs27QSUthOCPn/SCDYp+dZuf6/4
    wCinGZQyU+XGtC9I/f7OoH+uFEmV4VmFW4KelBjBjW1ftGfgf1fUsrlXrTwsdY94mVI64zJMU8wV
    AdScIiMVG2nQ4RvTUBH7IjVy/xEFXM7Or16zPY6TPNma9MkewbQs6jbeV2yjVrMxXq2jcZMfwCyW
    MiHRTv73/qVFYfatek8hV3IMh7NR5hW1nzmatDTH4KQTAk8EnYDYdi9aOmrXQ5+SzJzQW9aDetnp
    dXqNaCrkiYBMAcw7YEBgipSunMl9d3wOvDvXPzRZCD9glZkgC/45nQn/iAO+8zNyblYwyG2wJWI6
    5ZLbzZ7Pz2i/IfXD9dNxDdm909itYzaHzAl8e5hJVYsHa2DOxxYiK5vjbWqfQefm8DipMj1YFzjB
    Zr/KQo0FbNLSTtnMR1Hm1I/AEYYQVYCmvppksMa5N/+XlClpUZxgpSWcy+1BlEusyo4Nt5ueBdze
    L0lnQTggl+FxVX6s/AvVRcC7pMKFK/1Qv1DaRpRver3rdtQ4l5jSKU5KEwV2fhnFMJ7pCMn1VZOC
    FS8g6UTA2REgop7eJiic5phrWSZNhGpKhYlwmSV7q3ueBO+cDHTZ6NhQb4UanChNTyDfx2EaJKwy
    pMVRjPl6fQpm9QY7lKssAuo2QTTL/Jg0lbsfrjrdm9tO77LT3TcFz7GDUzKbM+1HZber6pc0WEe1
    /hMuwSclOMOh64sV3ezpGhfTbifVF/7vP7XU4A7SuL3ucNZgbcOxZrSgEy645XA07hjg8VIaDp5f
    +vePD8OIfNT/upXOlbFDsCulFynx9W3tvAgv12EsAItLRYffbt46TKfYPikZqu2O3Zf1xE4JMdUC
    fhVSfeqMLcphtikzV32hlbe009hSduhyXHU7B/BO96XFbzd/AUTPZCl85MbE5CNs0I0XtP4CHGxy
    VFILAAA=
- path: /root/provision.sh
  owner: root:root
  permissions: '0744'
  encoding: gz+base64
  content: |
    H4sICMY1rWICA3Byb3Zpc2lvbi5zaACdVttu20YQfRa/Ykw7dVuEN9ktXCZSkDROXtw6sFP0wXGB
    FTmUFiJ32d2lHKP2v3eWF4uUaKSoHwzt7lzOzDkz0uFBsOAiWDC9cg6dQzArrkFVQoMUgBtU97CQ
    0rwELUEgphqMhAUCT7EopUFhHI0GPKwklLzEjPHccXIpliupxB8a/1zJHN9zvZ5lLNf49FRfBSlu
    Ap2y3q2aBRumgpwvgu7ScXgGNzdwAJ6CAE0SKCaSFapgfaIDhUuujeKo/XtW5HB7C6+oDBQOACYr
    Ce6SAF5fX8CvbyFBZSCTCkrFN8wgtN73kDCK6JJPwgy8fu2dX36A+TezOZOCKyWVjp0JQCqTNSqf
    SzqhSEvJhakfPAB3ZUyp4yCIfpn60c9n/mnoT0/O4pNoeuY6E0pHue8sVO+S7L2/G49xhyBhfqKM
    C1/ICeABDCJ4rIGrdR7YOjVZefYDzzgVRYjJxcm44zRtId6qEt7+9hk0Ks5ySKTQRJbrLBWWFoEx
    99enTVAuuDFsAQ8PTVOP67c4VqhLdifiQFsZEXxzD94FRNFP0zBsA2xMFIbHMJ8PQo1l0ZhUqo4x
    zLN1frIYVpGSmmpeL1rNuK1mvAW4R//0RffoDiTSmPVs+pol29kMXKMqHHp1fgdjCaJd206IAJXm
    Ygl3Nn6Decd1UAOkzDC3jdCT5QOUTBlM9ytzJqRrGslJsc7ZAnNYlvXB2lvJF4yUjl/NKYQvgEh5
    0QnP/lmjUskF1mfSCcG2E9u9XRv6N3OPvm+ze8VIaysiFz6+gxoHZIp0+aWN/wA148exvX11vHvv
    beA49MPw47vG4KhvkVQ0F9kUvDTe3pLsiZgf3B4fnrCYntA+PsOENRPS7NHxksoWqb2rkZO0E/R9
    3+11aKztBGm0ye7RExK3afdYpzt1pFJgm6puvp1UgEPaKnCHsGIbBEY7uShpPGwEbrgUb8ikA/OJ
    Ln+viv9NUUfEOXEU3/wV3/4Yb1noOIh6HPQZ6IOY7SbdHluMBIMq+3z5/hJ0VZaSOieJJFUXZusC
    wQriwQdcgtgUGIqojJwhzfsxh2Q3baWJKpixnA49HuGOm1VNVNP0Fo8sDVGYNwzaA23FN7VBscZp
    pkmoH8AzzTutui6mZ6eVOh7Cf6h+uEJ2JKWek61bsLUtJOUKdhxas2Jt37xyL+DITDchz6+uLq/i
    raDAzkUmK5EGiUJmVUSX315TMP9u2oT9SvKKnDbb2Bb+NDaZZHgA3VfCvnG9/DNtv4JG+lKVaUPx
    1qzrSLdb9jrci0jjO++dfVOUg/A7aCbDUBOrhImQ1HkCUeBLhXn9AcKwXg3zZ4IXm5373nHL1xP3
    xMmojHfo6ciu7elHQe/QDvhedxuy7L75F9Cmj4UPCgAA
run_cmd:
- "/root/provision.sh >> /root/provision.log 2>> /root/provision.err"
k3os:
  modules:
  - kvm
  - nvme
  sysctl:
    kernel.printk: "4 4 1 7"
    kernel.kptr_restrict: "1"
  ntp_servers:
  - 0.us.pool.ntp.org
  - 1.us.pool.ntp.org
#  server_url: https://192.168.40.10:6443
  token: SECRETSQUIRREL
  # TODO `openssl passwd -1`
  password: "k3os"
  k3s_args:
  - server
  - "--cluster-init"
  - "--tls-san"
  - "192.168.40.10"
  - "--tls-san"
  - "k8s.s.home.chaosengine.net"
  - "--disable"
  - "servicelb"
    #- "--node-external-ip"
    #- "192.168.136.10"
  #- "--secrets-encryption"
