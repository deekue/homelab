hostname: k3os-001
ssh_authorized_keys:
- github:deekue
- ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIBIMWQez3DYo1jeHOOE3nG7RPllzzpKW2p2R7QwmOaoj apathy@chelone
write_files:
- path: /var/lib/rancher/k3s/server/manifests/kube-vip-ds.yaml
  owner: root:root
  permissions: '0644'
  encoding: gz+base64
  content: |
    H4sICEo6wF8CA2t1YmUtdmlwLWRzLnlhbWwAlVXbbtpAEH3nK1a0j7GBkNDEL1Xa5AGpoVZAkfoU
    TewBVqx3rd0xFEX5985yXXNJVEtI+MyeM5edGUMpn9E6aXQioCxda95pzKTOE3EPWBg9RGoUSJAD
    QdIQIrMIxKdHskBHUJSJ0JVSbNFQYCJm1StGc1lGudtgroRsa3BLR1g0XImZF3OoMCNj/X8hCqBs
    +gteUbk1cFqTBUoFhBtSEJt/zsfnH1VTP63PYW3CW+kZTSA1l2iLRALsJNCIBPuxtHv/IoxWS1E5
    zMXYWPEEY/q+t0YiipTJQKWINoSbX9+841ibHAcc13vCAAFVLp4aR/30Pem0+WnWtSzfEuGh2Kxr
    XNRuXyad28u407uJO91e3LnqrSUuNuZu3XzdXZuD1DjW1x/cDiPzLMsD3AcZQKsqQikPTqUmqA1n
    2bu66jYPPUA2Q72p/hoOA7v9lnjWxWEuxyBn4MGdDup5eFHr6+abfgG7z0aIOaiKDU2yFTZPnpea
    0I65kY9ZSNP2aR95btG5Y0Yt5NNchZCjXY0HN/N/hcpUbr3Kwhnm9WmaRY2LnN0q7vYTtO45Gtll
    iVaa/ASpU2vWPYunaiwnBZTB1OxIAUfM23EnvhULcII9VVZLPRHP/VSYjJA8OOfR5EmTWkzuntId
    VRYwYbFS6dy2tgOeeLWb+pmUt0NqlMyWibhTC1i6M9thB/Olmspm6BLx9r5DHWaVlbT8yQsD/1IS
    VCODEl6lkiTRhbgQ3CJ1IBKDh9HL3f1jf3CAD/8MX0b9x4cdPDeqKvDRVJpq26jwSAo0TUQLKVsl
    bzUSuhbkhdSxL34gvs9yfSsfSDmnWhlackf0DKJDAy/i/DdvwkT4Xt0Y/CYbIC2MndVwv/SGta/B
    Fo2sURjvk4ilaRXAnxF7MAXE59ZNH6xqHI9ZMxEDM8ymPBVq39oz5NA+9tAIKx2o+ixWZQnSLfdl
    sqDZGbdd1/lfvIRCNT4p96eix7U/qnxV8pcQh8RVwMly1Z3/AJPWi63fBwAA
- path: /etc/rancher/k3s/registries.yaml
  owner: root:root
  permissions: '0644'
  encoding: base64
  content: |
    bWlycm9yczoKICBkb2NrZXIuaW86CiAgICBlbmRwb2ludDoKICAgICAgLSAgImh0dHBzOi8vMTky
    LjE2OC4xMzYuMjM4OjMxMjgiCg==
run_cmd:
- "wget -O - -q http://192.168.136.238:3128/ca.crt | sudo tee -a /etc/ssl/certs/ca-certificates.crt"
k3os:
  modules:
  - kvm
  sysctl:
    kernel.printk: "4 4 1 7"
    kernel.kptr_restrict: "1"
  ntp_servers:
  - 0.us.pool.ntp.org
  - 1.us.pool.ntp.org
#  server_url: https://192.168.136.10:6443
  token: SECRETSQUIRREL
  password: "k3os"
  k3s_args:
  - server
  - "--cluster-init"
  - "--tls-san"
  - "192.168.136.10"
  - "--tls-san"
  - "k8s.s.home.chaosengine.net"
    #- "--node-external-ip"
    #- "192.168.136.10"
  #- "--secrets-encryption"
